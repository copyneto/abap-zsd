sap.ui.define(["sap/m/PDFViewer"],function(e){"use strict";return{onBaixarLayout:function(t){var a="layoutSet(Guid='')/$value";var s="/sap/opu/odata/sap/ZSD_COCKPIT_AGENDAMENTO_SRV/";var i=s+a;var r=new e;this.getView().addDependent(r);r.setSource(i);r.d+
ownloadPDF()},onUploadExcel:function(e){var t=this;var a=new sap.m.Dialog({contentWidth:"300px",resizable:true,type:"Message"});a.setTitle("Carregar arquivo Excel");var s="/sap/opu/odata/sap/ZSD_COCKPIT_AGENDAMENTO_SRV/";var i=new sap.ui.model.odata.ODat+
aModel(s,false);var r=s+"uploadSet";var n=new sap.ui.unified.FileUploader({width:"100%",fileType:["xlsx","xls"],typeMissmatch:this.handleTypeMissmatch,uploadComplete:function(e){var t=this;var s=this.oView.sId+"--responsiveTable";var i=this.byId(s);t.tem+
plateBaseExtension.getExtensionAPI().refreshTable();a.close();a.destroy();if(e.mParameters.status=="200"||e.mParameters.status=="201"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{var r=[];try{var n=jQuery.parseXML(e.mParameters.responseR+
aw);var o=n.children[0].children[2].children[4].children;let t;for(var l=0;l<o.length;l++){t=o[l].children[3].innerHTML[0].toUpperCase()+o[l].children[3].innerHTML.substring(1);r.push({type:t,title:o[l].children[1].innerHTML,description:o[l].children[1].+
innerHTML})}}catch(e){}var p=new sap.ui.model.json.JSONModel(r);this.getView().setModel(p,"msgResult");var u=new sap.m.MessageItem({type:"{type}",title:"{title}",description:"{description}",subtitle:"{subtitle}",counter:"{counter}",markupDescription:"{ma+
rkupDescription}"});this.oMessageView=new sap.m.MessageView({showDetailsPageHeader:false,itemSelect:function(){d.setVisible(true)},items:{path:"/",template:u}});var d=new sap.m.Button({icon:sap.ui.core.IconPool.getIconURI("nav-back"),visible:false,press:+
function(){t.oMessageView.navigateBack();this.setVisible(false)}});this.oMessageView.setModel(p);this.oDialog=new sap.m.Dialog({resizable:true,content:this.oMessageView,state:"Error",beginButton:new sap.m.Button({press:function(){this.getParent().close()+
},text:"Close"}),customHeader:new sap.m.Bar({contentMiddle:[new sap.m.Text({text:"Carga de arquivo"})],contentLeft:[d]}),contentHeight:"25%",contentWidth:"25%",verticalScrolling:false});this.oMessageView.navigateBack();this.oDialog.open()}}.bind(this)});+
n.setName("Simple Uploader");n.setUploadUrl(r);n.setSendXHR(true);n.setUseMultipart(false);n.setUploadOnChange(false);var o=new sap.ui.unified.FileUploaderParameter({name:"x-csrf-token",value:i.getSecurityToken()});n.insertHeaderParameter(o);var l=new sa+
p.m.Button({text:"Upload",type:"Accept",press:function(){var e=n.getFocusDomRef();var t=e.files[0];if(n.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquivo");return}var a=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",val+
ue:t.type});n.insertHeaderParameter(a);n.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:n.getValue()}));n.upload()}.bind(this)});var p=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){a.close();a.destroy+
();this.getView().removeAllDependents()}.bind(this)});a.addContent(n);a.setBeginButton(p);a.setEndButton(l);a.open()},handleTypeMissmatch:function(e){var t=e.getSource().getFileType();jQuery.each(t,function(e,a){t[e]="*."+a});var a=t.join(", ");sap.m.Mes+
sageToast.show("Tipo de arquivo *."+e.getParameter("fileType")+" não é suportado. Escolha um dos tipos a seguir: "+a)}}});                                                                                                                                     