sap.ui.define(["sap/m/PDFViewer","sap/m/VBox","sap/m/Label","sap/ui/core/util/File"],function(e){"use strict";return sap.ui.controller("br.com.trescoracoes.cockpitdevolucao.ext.controller.ObjectPageExt",{onAnexar:function(e){var a=e.getSource().getBindin+
gContext().getObject();if(a.Nfe==" "){sap.m.MessageToast.show("Não é possível anexar arquivo  sem número de Nfe");return}var t=new sap.m.Dialog({contentWidth:"300px",resizable:true});t.setTitle("Carregar arquivo");var r="/sap/opu/odata/SAP/ZSD_COCKPIT_DE+
VOLUCAO_ANEXO1_SRV/";var s=new sap.ui.model.odata.ODataModel(r);var o=r+"fileSet";var i=new sap.ui.unified.FileUploader({width:"100%",uploadComplete:function(e){this.oView.getController().extensionAPI.refresh();t.close();t.destroy();if(e.mParameters.stat+
us=="200"||e.mParameters.status=="201"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{if(e.mParameters.response){if(e.mParameters.responseRaw.search("<message>")){var a=e.mParameters.responseRaw.split("<message>")[1].split("</message>")[0]+
;alert(a)}else{alert("Return Code: "+e.mParameters.response,"Response","Response")}}}}.bind(this)});i.setName("Simple Uploader");i.setUploadUrl(o);i.setSendXHR(true);i.setUseMultipart(false);i.setUploadOnChange(false);var n=new sap.ui.unified.FileUploade+
rParameter({name:"x-csrf-token",value:s.getSecurityToken()});i.insertHeaderParameter(n);var l=new sap.m.Button({text:"Upload",type:"Accept",press:function(){var e=i.getFocusDomRef();var a=e.files[0];if(i.getValue()===""){sap.m.MessageToast.show("Favor se+
lecionar um arquivo");return}var t=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",value:a.type});i.insertHeaderParameter(t);var r=this.getView().getBindingContext();var s=r.getPath();var o=r.getModel().getProperty(s);i.insertHeaderParamete+
r(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:i.getValue()+";"+o.Guid}));i.upload()}.bind(this)});var u=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){t.close();t.destroy();this.getView().removeAllDependents()}.bind(this+
)});t.addContent(i);t.setBeginButton(u);t.setEndButton(l);t.open()},onBaixar:function(e){var a=e.getSource().getBindingContext().getObject();var t=e.getSource().getParent().getParent().getItems();var r=undefined;t.forEach((e,a)=>{if(e.mProperties.selecte+
d)r=a+1});var s="/sap/opu/odata/SAP/ZSD_COCKPIT_DEVOLUCAO_ANEXO1_SRV/";var o=new sap.ui.model.odata.ODataModel(s,false);var i="fileSet(Guid='"+a.Guid+"',Line='"+r+"')/$value";o.read(i,null,null,true,function(e,a,t){sap.m.URLHelper.redirect(t.requestUri,t+
rue)}.bind(s,i),function(e){if(e.response.body.search("<message>")){var a=e.response.body.split("<message>")[1].split("</message>")[0];alert(a)}else{alert("Falha ao buscar arquivo")}})},onExibir:function(a){var t=a.getSource().getBindingContext().getObje+
ct();var r=a.getSource().getParent().getParent().getItems();var s=undefined;r.forEach((e,a)=>{if(e.mProperties.selected)s=a+1});var o="/sap/opu/odata/SAP/ZSD_COCKPIT_DEVOLUCAO_ANEXO1_SRV/";var i="fileShowSet(Guid='"+t.Guid+"',Line='"+s+"')/$value";var n=+
o+i;var l=new e;this.getView().addDependent(l);l.setSource(n);l.setShowDownloadButton(false);l.open();if(a.mParameters.responseRaw.search("<message>")){var u=a.mParameters.responseRaw.split("<message>")[1].split("</message>")[0];alert("Falha ao exibir o +
arquivo")}else{alert("Falha ao exibir o arquivo")}}})});                                                                                                                                                                                                       