sap.ui.define([                                                                                                                                                                                                                                                
    "sap/ui/model/Filter",                                                                                                                                                                                                                                     
    "sap/ui/model/FilterOperator",                                                                                                                                                                                                                             
    "sap/m/MessageToast",                                                                                                                                                                                                                                      
    "sap/ui/comp/smartfilterbar/SmartFilterBar",                                                                                                                                                                                                               
    "sap/ui/model/SimpleType",                                                                                                                                                                                                                                 
    "sap/ui/model/ValidateException"                                                                                                                                                                                                                           
],                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
    function (Filter, FilterOperator, MessageToast, ValidateException) {                                                                                                                                                                                       
        "use strict";                                                                                                                                                                                                                                          
        return sap.ui.controller("br.com.trescoracoes.cockpitfaturamento.ext.controller.ListReportExt", {                                                                                                                                                      
                                                                                                                                                                                                                                                               
            onInitSmartFilterBarExtension: function (oEvent) {                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
                /* ===================================================================                                                                                                                                                                         
                  Monta filtro seleção                                                                                                                                                                                                                         
                  =================================================================== */                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                var today = new Date(); // Data Atual                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                // Lógica para Data Liberação                                                                                                                                                                                                                  
                var vData = today.toLocaleDateString()                                                                                                                                                                                                         
                var vDataFinal = vData.replace(/\//g, '.');                                                                                                                                                                                                    
                var vDataLiberacao = vDataFinal + '-23:59:59';                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                // Lógica para a Data de criação do documento                                                                                                                                                                                                  
                var diasDif = 30; // Diferença de 30 dias                                                                                                                                                                                                      
                var milissegundosPorDia = 1000 * 60 * 60 * 24;                                                                                                                                                                                                 
                var dataDesteHora = new Date(today.getTime() - diasDif * milissegundosPorDia); // Calculo data atual - 90 dias                                                                                                                                 
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                var dateFormattedDesde = new Intl.DateTimeFormat("en-US", {                                                                                                                                                                                    
                    year: "numeric",                                                                                                                                                                                                                           
                    month: "2-digit",                                                                                                                                                                                                                          
                    day: "2-digit"                                                                                                                                                                                                                             
                }).format(dataDesteHora); // Converte data para o formato americano MM/DD/AAAA                                                                                                                                                                 
                var dataDesteFinal = dateFormattedDesde.replace(/\//g, '.'); //Converte data para MM.DD.AAAA                                                                                                                                                   
                                                                                                                                                                                                                                                               
                var dateFormattedAte = new Intl.DateTimeFormat("en-US", {                                                                                                                                                                                      
                    year: "numeric",                                                                                                                                                                                                                           
                    month: "2-digit",                                                                                                                                                                                                                          
                    day: "2-digit"                                                                                                                                                                                                                             
                }).format(today);                                                                                                                                                                                                                              
                var dataAteFinal = dateFormattedAte.replace(/\//g, '.');                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                var oFilters = {                                                                                                                                                                                                                               
                    "DataLiberacao": {                                                                                                                                                                                                                         
                        "ranges": [{                                                                                                                                                                                                                           
                            "exclude": false,                                                                                                                                                                                                                  
                            "operation": "BT",                                                                                                                                                                                                                 
                            "keyField": "DataLiberacao",                                                                                                                                                                                                       
                            "value1": '00.00.0000-00:00:00',                                                                                                                                                                                                   
                            "value2": vDataLiberacao,                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                        }]                                                                                                                                                                                                                                     
                    },                                                                                                                                                                                                                                         
                    "CreationDate": {                                                                                                                                                                                                                          
                        "ranges": [{                                                                                                                                                                                                                           
                            "exclude": false,                                                                                                                                                                                                                  
                            "operation": "BT",                                                                                                                                                                                                                 
                            "keyField": "CreationDate",                                                                                                                                                                                                        
                            "value1": dataDesteFinal,//MM.DD.AAAA                                                                                                                                                                                              
                            "value2": dataAteFinal,//MM.DD.AAAA                                                                                                                                                                                                
                        }]                                                                                                                                                                                                                                     
                    },                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                };                                                                                                                                                                                                                                             
                /* ===================================================================                                                                                                                                                                         
                  Atualiza filtros de seleção                                                                                                                                                                                                                  
                  =================================================================== */                                                                                                                                                                       
                var oGlobalFilter = oEvent.getSource();                                                                                                                                                                                                        
                oGlobalFilter.setFilterData(oFilters);                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            onBeforeRebindTableExtension: function (oEvent) {                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                var oBindingParams = oEvent.getParameter('bindingParams');                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                if (oBindingParams && oBindingParams.filters && oBindingParams.filters[0] && oBindingParams.filters[0].aFilters && oBindingParams.filters.length > 0) {                                                                                        
                    var aFilters = oBindingParams.filters[0].aFilters;                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                    var creationDate = aFilters.filter(res => res.aFilters[0].sPath === "CreationDate")[0];                                                                                                                                                    
                    var value1 = creationDate.aFilters[0].oValue1;                                                                                                                                                                                             
                    var value2 = creationDate.aFilters[0].oValue2;                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                    const diffInMs = value2 - value1                                                                                                                                                                                                           
                    const diffInDays = diffInMs / (1000 * 60 * 60 * 24);                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                    if (diffInDays > 90) {                                                                                                                                                                                                                     
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                     
                        debugger                                                                                                                                                                                                                               
                        alert('Período selecionado ultrapassa 90 dias');                                                                                                                                                                                       
                        ValidateException('Período selecionado ultrapassa 90 dias')                                                                                                                                                                            
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                       
                    //    throw new Error(c);                                                                                                                                                                                                                  
                    }                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
            onConsultaDisponibilidade: function (oEvent) {                                                                                                                                                                                                     
                /* ===================================================================                                                                                                                                                                         
                  Monta uma tabela com as linhas selecionadas                                                                                                                                                                                                  
                  =================================================================== */                                                                                                                                                                       
                var oSelection = this.extensionAPI.getSelectedContexts();                                                                                                                                                                                      
                var oSalesOrders = [];                                                                                                                                                                                                                         
                var oMaterial = [];                                                                                                                                                                                                                            
                var oPlant = [];                                                                                                                                                                                                                               
                var oDeposito = [];                                                                                                                                                                                                                            
                var oMaterialCont = 0;                                                                                                                                                                                                                         
                var oPlantCont = 0;                                                                                                                                                                                                                            
                var oDepositoCont = 0;                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                for (let i = 0; i < oSelection.length; i++) {                                                                                                                                                                                                  
                    oSalesOrders[i] = oSelection[i].getObject().SalesOrder;                                                                                                                                                                                    
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                /* ===================================================================                                                                                                                                                                         
                Consulta Material pelas Ordens selecionadas                                                                                                                                                                                                    
                =================================================================== */                                                                                                                                                                         
                var sUrl = "/sap/opu/odata/SAP/ZC_SD_CKPT_FAT_FILTRO_DIP_CDS/";                                                                                                                                                                                
                var oFilter = [];                                                                                                                                                                                                                              
                var aFilters = [];                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                var oDataModel = new sap.ui.model.odata.v2.ODataModel(sUrl, {                                                                                                                                                                                  
                    json: true,                                                                                                                                                                                                                                
                    loadMetadataAsync: true                                                                                                                                                                                                                    
                });                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                for (let i = 0; i < oSalesOrders.length; i++) {                                                                                                                                                                                                
                    oFilter.push(new Filter("SalesDocument", FilterOperator.EQ, oSalesOrders[i]));                                                                                                                                                             
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                aFilters = new Filter({                                                                                                                                                                                                                        
                    filters: oFilter,                                                                                                                                                                                                                          
                    and: false                                                                                                                                                                                                                                 
                });                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                oDataModel.read("/BuscaMaterialSet", {                                                                                                                                                                                                         
                    filters: [aFilters],                                                                                                                                                                                                                       
                    success: function (oData, response) {                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                        for (let i = 0; i < oData.results.length; i++) {                                                                                                                                                                                       
                            if (!oMaterial.includes(oData.results[i].Material) && oData.results[i].Material != null && oData.results[i].Material != undefined && oData.results[i].Material != "") {                                                            
                                oMaterial[oMaterialCont] = oData.results[i].Material;                                                                                                                                                                          
                                oMaterialCont++                                                                                                                                                                                                                
                            }                                                                                                                                                                                                                                  
                            if (!oPlant.includes(oData.results[i].Plant) && oData.results[i].Plant != null && oData.results[i].Plant != undefined && oData.results[i].Plant != "") {                                                                           
                                oPlant[oPlantCont] = oData.results[i].Plant;                                                                                                                                                                                   
                                oPlantCont++                                                                                                                                                                                                                   
                            }                                                                                                                                                                                                                                  
                            if (!oDeposito.includes(oData.results[i].StorageLocation) && oData.results[i].StorageLocation != null && oData.results[i].StorageLocation != undefined && oData.results[i].StorageLocation != "") {                                
                                oDeposito[oDepositoCont] = oData.results[i].StorageLocation;                                                                                                                                                                   
                                oDepositoCont++                                                                                                                                                                                                                
                            }                                                                                                                                                                                                                                  
                        }                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                        /* ===================================================================                                                                                                                                                                 
                        Verifica se usuário tem permissão para navegação                                                                                                                                                                                       
                        =================================================================== */                                                                                                                                                                 
                        sap.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported([{                                                                                                                                                 
                            target: {                                                                                                                                                                                                                          
                                shellHash: "verifdisp-create"                                                                                                                                                                                                  
                            }                                                                                                                                                                                                                                  
                        }])                                                                                                                                                                                                                                    
                            .done(function (aResponse) {                                                                                                                                                                                                       
                                aResponse.map(function (elem, index) {                                                                                                                                                                                         
                                    if (elem.supported === true) {                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                                        /* ===================================================================                                                                                                                                                 
                                        Chama outro aplicativo                                                                                                                                                                                                 
                                        =================================================================== */                                                                                                                                                 
                                        var href_parameters = (sap.ushell && sap.ushell.Container &&                                                                                                                                                           
                                            sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({                                                                                                                                    
                                                target: {                                                                                                                                                                                                      
                                                    semanticObject: "verifdisp",                                                                                                                                                                               
                                                    action: "create"                                                                                                                                                                                           
                                                },                                                                                                                                                                                                             
                                                params: {                                                                                                                                                                                                      
                                                    Material: oMaterial,                                                                                                                                                                                       
                                                    Plant: oPlant,                                                                                                                                                                                             
                                                    Deposito: oDeposito                                                                                                                                                                                        
                                                },                                                                                                                                                                                                             
                                            }));                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                        sap.m.URLHelper.redirect(href_parameters, false);                                                                                                                                                                      
                                    } else {                                                                                                                                                                                                                   
                                        alert('Usuário sem permissão para acessar o link');                                                                                                                                                                    
                                    }                                                                                                                                                                                                                          
                                })                                                                                                                                                                                                                             
                            })                                                                                                                                                                                                                                 
                            .fail(function () {                                                                                                                                                                                                                
                                alert('Falha ao acessar o link');                                                                                                                                                                                              
                            });                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                        sap.m.URLHelper.redirect(href_funcao, true);                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                    },                                                                                                                                                                                                                                         
                    error: function (response) {                                                                                                                                                                                                               
                        MessageToast.show("Todos os itens estão concluídos!");                                                                                                                                                                                 
                    }                                                                                                                                                                                                                                          
                });                                                                                                                                                                                                                                            
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            onEmissaoNF: function (oEvent) {                                                                                                                                                                                                                   
                /* ===================================================================                                                                                                                                                                         
                  Monta uma tabela com as linhas selecionadas                                                                                                                                                                                                  
                  =================================================================== */                                                                                                                                                                       
                var oSelection = this.extensionAPI.getSelectedContexts();                                                                                                                                                                                      
                var oSalesOrders = [];                                                                                                                                                                                                                         
                var oMaterial = [];                                                                                                                                                                                                                            
                var oPlant = [];                                                                                                                                                                                                                               
                var oCentro = [];                                                                                                                                                                                                                              
                var oDeposito = [];                                                                                                                                                                                                                            
                var oMaterialCont = 0;                                                                                                                                                                                                                         
                var oPlantCont = 0;                                                                                                                                                                                                                            
                var oCentroCont = 0;                                                                                                                                                                                                                           
                var oDepositoCont = 0;                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                for (let i = 0; i < oSelection.length; i++) {                                                                                                                                                                                                  
                    oSalesOrders[i] = oSelection[i].getObject().SalesOrder;                                                                                                                                                                                    
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                /* ===================================================================                                                                                                                                                                         
                Consulta Material pelas Ordens selecionadas                                                                                                                                                                                                    
                =================================================================== */                                                                                                                                                                         
                //var sUrl = "/sap/opu/odata/SAP/ZSD_BUSCA_MATERIAL_SRV/";                                                                                                                                                                                     
                var sUrl = "/sap/opu/odata/SAP/ZC_SD_CKPT_FAT_FILTRO_ARM_CDS/";                                                                                                                                                                                
                var oFilter = [];                                                                                                                                                                                                                              
                var aFilters = [];                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                var oDataModel = new sap.ui.model.odata.v2.ODataModel(sUrl, {                                                                                                                                                                                  
                    json: true,                                                                                                                                                                                                                                
                    loadMetadataAsync: true                                                                                                                                                                                                                    
                });                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                for (let i = 0; i < oSalesOrders.length; i++) {                                                                                                                                                                                                
                    //  oFilter.push(new Filter("Vbeln", FilterOperator.EQ, oSalesOrders[i]));                                                                                                                                                                 
                    oFilter.push(new Filter("SalesDocument", FilterOperator.EQ, oSalesOrders[i]));                                                                                                                                                             
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                aFilters = new Filter({                                                                                                                                                                                                                        
                    filters: oFilter,                                                                                                                                                                                                                          
                    //and: true                                                                                                                                                                                                                                
                    and: false                                                                                                                                                                                                                                 
                });                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                //oDataModel.read("/BuscaMateriaNFSet", {                                                                                                                                                                                                      
                oDataModel.read("/BuscaMaterialSet", {                                                                                                                                                                                                         
                    filters: [aFilters],                                                                                                                                                                                                                       
                    success: function (oData, response) {                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                        //for (let i = 0; i < oData.results.length; i++) {                                                                                                                                                                                     
                        //    oMaterial[i] = oData.results[i].Matnr;                                                                                                                                                                                           
                        //    oPlant[i] = oData.results[i].Werks;                                                                                                                                                                                              
                        //    oCentro[i] = oData.results[i].Centrodepfechado;                                                                                                                                                                                  
                        //    oDeposito[i] = oData.results[i].Lgort;                                                                                                                                                                                           
                        // }                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
                        for (let i = 0; i < oData.results.length; i++) {                                                                                                                                                                                       
                            if (!oMaterial.includes(oData.results[i].Material) && oData.results[i].Material != null && oData.results[i].Material != undefined && oData.results[i].Material != "") {                                                            
                                oMaterial[oMaterialCont] = oData.results[i].Material;                                                                                                                                                                          
                                oMaterialCont++                                                                                                                                                                                                                
                            }                                                                                                                                                                                                                                  
                            if (!oPlant.includes(oData.results[i].Plant) && oData.results[i].Plant != null && oData.results[i].Plant != undefined && oData.results[i].Plant != "") {                                                                           
                                oPlant[oPlantCont] = oData.results[i].Plant;                                                                                                                                                                                   
                                oPlantCont++                                                                                                                                                                                                                   
                            }                                                                                                                                                                                                                                  
                            if (!oCentro.includes(oData.results[i].centrofaturamento) && oData.results[i].centrofaturamento != null && oData.results[i].centrofaturamento != undefined && oData.results[i].centrofaturamento != "") {                          
                                oCentro[oCentroCont] = oData.results[i].centrofaturamento;                                                                                                                                                                     
                                oCentroCont++                                                                                                                                                                                                                  
                            }                                                                                                                                                                                                                                  
                            if (!oDeposito.includes(oData.results[i].StorageLocation) && oData.results[i].StorageLocation != null && oData.results[i].StorageLocation != undefined && oData.results[i].StorageLocation != "") {                                
                                oDeposito[oDepositoCont] = oData.results[i].StorageLocation;                                                                                                                                                                   
                                oDepositoCont++                                                                                                                                                                                                                
                            }                                                                                                                                                                                                                                  
                        }                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                        /* ===================================================================                                                                                                                                                                 
                        Verifica se usuário tem permissão para navegação                                                                                                                                                                                       
                        =================================================================== */                                                                                                                                                                 
                        sap.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported([{                                                                                                                                                 
                            target: {                                                                                                                                                                                                                          
                                shellHash: "retArmaz-manage"                                                                                                                                                                                                   
                            }                                                                                                                                                                                                                                  
                        }])                                                                                                                                                                                                                                    
                            .done(function (aResponse) {                                                                                                                                                                                                       
                                aResponse.map(function (elem, index) {                                                                                                                                                                                         
                                    if (elem.supported === true) {                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                                        /* ===================================================================                                                                                                                                                 
                                        Chama outro aplicativo                                                                                                                                                                                                 
                                        =================================================================== */                                                                                                                                                 
                                        var href_parameters = (sap.ushell && sap.ushell.Container &&                                                                                                                                                           
                                            sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({                                                                                                                                    
                                                target: {                                                                                                                                                                                                      
                                                    semanticObject: "retArmaz",                                                                                                                                                                                
                                                    action: "manage"                                                                                                                                                                                           
                                                },                                                                                                                                                                                                             
                                                params: {                                                                                                                                                                                                      
                                                    EANType: '00',                                                                                                                                                                                             
                                                    Material: oMaterial,                                                                                                                                                                                       
                                                    CentroDestino: oPlant,                                                                                                                                                                                     
                                                    CentroOrigem: oCentro,                                                                                                                                                                                     
                                                    DepositoDestino: oDeposito,                                                                                                                                                                                
                                                    DepositoOrigem: oDeposito                                                                                                                                                                                  
                                                },                                                                                                                                                                                                             
                                            }));                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                        sap.m.URLHelper.redirect(href_parameters, false);                                                                                                                                                                      
                                    } else {                                                                                                                                                                                                                   
                                        alert('Usuário sem permissão para acessar o link');                                                                                                                                                                    
                                    }                                                                                                                                                                                                                          
                                })                                                                                                                                                                                                                             
                            })                                                                                                                                                                                                                                 
                            .fail(function () {                                                                                                                                                                                                                
                                alert('Falha ao acessar o link');                                                                                                                                                                                              
                            });                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                        sap.m.URLHelper.redirect(href_funcao, true);                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                    },                                                                                                                                                                                                                                         
                    error: function (response) {                                                                                                                                                                                                               
                        MessageToast.show("Todos os itens estão concluídos!");                                                                                                                                                                                 
                    }                                                                                                                                                                                                                                          
                });                                                                                                                                                                                                                                            
            },                                                                                                                                                                                                                                                 
            onRecusarOrdem: function (oEvent) {                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                /* ===================================================================                                                                                                                                                                         
                Monta uma tabela com as linhas selecionadas                                                                                                                                                                                                    
                =================================================================== */                                                                                                                                                                         
                var oSelection = this.extensionAPI.getSelectedContexts();                                                                                                                                                                                      
                var oSalesOrder = [];                                                                                                                                                                                                                          
                var oPlant = [];                                                                                                                                                                                                                               
                var oSalesOrganization = [];                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
                for (let i = 0; i < oSelection.length; i++) {                                                                                                                                                                                                  
                    if (oSelection[i].getObject().StatusDeliveryBlockReason == 'Pendente') {                                                                                                                                                                   
                        sap.m.MessageToast.show("Impossível recusar, pedido sem liberação comercial");                                                                                                                                                         
                        return;                                                                                                                                                                                                                                
                    }                                                                                                                                                                                                                                          
                    oSalesOrder[i] = oSelection[i].getObject().SalesOrder;                                                                                                                                                                                     
                    oPlant[i] = oSelection[i].getObject().Plant;                                                                                                                                                                                               
                    oSalesOrganization[i] = oSelection[i].getObject().SalesOrganization;                                                                                                                                                                       
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                /* ===================================================================                                                                                                                                                                         
                Verifica se usuário tem permissão para navegação                                                                                                                                                                                               
                =================================================================== */                                                                                                                                                                         
                sap.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported([                                                                                                                                                          
                    { target: { shellHash: "sdmotivorecitem-change" } }                                                                                                                                                                                        
                ])                                                                                                                                                                                                                                             
                    .done(function (aResponse) {                                                                                                                                                                                                               
                        aResponse.map(function (elem, index) {                                                                                                                                                                                                 
                            if (elem.supported === true) {                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                                /* ===================================================================                                                                                                                                                         
                                Chama outro aplicativo                                                                                                                                                                                                         
                                =================================================================== */                                                                                                                                                         
                                var href_parameters = (sap.ushell && sap.ushell.Container &&                                                                                                                                                                   
                                    sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({                                                                                                                                            
                                        target: { semanticObject: "sdmotivorecitem", action: "change" },                                                                                                                                                       
                                        params: {                                                                                                                                                                                                              
                                            SalesOrder: oSalesOrder,                                                                                                                                                                                           
                                            Plant: oPlant,                                                                                                                                                                                                     
                                            SalesOrganization: oSalesOrganization                                                                                                                                                                              
                                        },                                                                                                                                                                                                                     
                                    }));                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                                sap.m.URLHelper.redirect(href_parameters, false);                                                                                                                                                                              
                            }                                                                                                                                                                                                                                  
                            else {                                                                                                                                                                                                                             
                                alert('Usuário sem permissão para acessar o link');                                                                                                                                                                            
                            }                                                                                                                                                                                                                                  
                        })                                                                                                                                                                                                                                     
                    })                                                                                                                                                                                                                                         
                    .fail(function () {                                                                                                                                                                                                                        
                        alert('Falha ao acessar o link');                                                                                                                                                                                                      
                    });                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                sap.m.URLHelper.redirect(href_funcao, true);                                                                                                                                                                                                   
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
            /* ===================================================================                                                                                                                                                                             
                Removendo uma condição de filtro no relatório&nbsp;                                                                                                                                                                                            
                =================================================================== */                                                                                                                                                                         
            // onBeforeRebindTableExtension: function (oEvent) {                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
            //     /* ===================================================================                                                                                                                                                                      
            //       Verifica se o filtro Material esta preenchido                                                                                                                                                                                             
            //       =================================================================== */                                                                                                                                                                    
            //     var oBindingParams = oEvent.getParameter('bindingParams');                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            //     if (oBindingParams && oBindingParams.filters && oBindingParams.filters[0] && oBindingParams.filters[0].aFilters && oBindingParams.filters.length > 0) {                                                                                     
            //         var aFilter = oBindingParams.filters[0].aFilters;                                                                                                                                                                                       
            //         // if(aFilter){                                                                                                                                                                                                                         
            //         var temMaterial = false;                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
            //         for (var element of aFilter) {                                                                                                                                                                                                          
            //             temMaterial = element.aFilters ?                                                                                                                                                                                                    
            //                 element.aFilters.filter(res => res.sPath === "Material").length > 0 :                                                                                                                                                           
            //                 element.sPath === "Material";                                                                                                                                                                                                   
            //             if (temMaterial) break;                                                                                                                                                                                                             
            //         };                                                                                                                                                                                                                                      
            //         // }                                                                                                                                                                                                                                    
            //         /* ===================================================================                                                                                                                                                                  
            //         Se o material estiver preenchido, busca o filtro item para limpar os dados de seleção                                                                                                                                                   
            //         =================================================================== */                                                                                                                                                                  
            //         if (temMaterial) {                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
            //             for (var i = 0; i <= aFilter.length - 1; i++) {                                                                                                                                                                                     
            //                 if (aFilter[i].aFilters) {                                                                                                                                                                                                      
            //                     for (var j = 0; j <= aFilter[i].aFilters.length - 1; j++) {                                                                                                                                                                 
            //                         if (aFilter[i].aFilters[j].sPath === "SalesOrderItem") { aFilter.splice(i, 1); break; };                                                                                                                                
            //                     }                                                                                                                                                                                                                           
            //                 } else {                                                                                                                                                                                                                        
            //                     if (aFilter[i].sPath === "SalesOrderItem") aFilter.splice(i, 1);                                                                                                                                                            
            //                 }                                                                                                                                                                                                                               
            //             }                                                                                                                                                                                                                                   
            //             oBindingParams.filters = aFilter;                                                                                                                                                                                                   
            //         }                                                                                                                                                                                                                                       
            //     }                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
            // },                                                                                                                                                                                                                                              
        });                                                                                                                                                                                                                                                    
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               